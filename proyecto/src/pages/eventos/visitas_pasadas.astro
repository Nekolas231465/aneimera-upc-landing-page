---
import NotFound from "../../components/NotFound.astro";
import VisitCard from "../../components/VisitCard.astro";
import { cards } from "../../data/visits-cards.ts";

// Función para convertir fecha de DD/MM/AAAA a AAAA-MM-DD
function convertDate(dateStr) {
    const [day, month, year] = dateStr.split('/');
    return new Date(`${year}-${month}-${day}`);
}

// Obtener la fecha actual
const today = new Date();

// Filtrar las tarjetas anteriores a la fecha actual
const pastCards = cards.filter(card => convertDate(card.visit_date) < today);
---

<section class="py-16 md:py-20 bg-blanco">
    <div class="section-container">
        <h1 class="text-2xl md:text-3xl text-black font-medium">
            Visitas técnicas pasadas:
        </h1>
        {pastCards.length > 0 ? (
            <div class="mt-10 grid grid-cols-1 md:grid-cols-2 grid-rows-auto gap-12">
                {pastCards.map((card) => (
                    <VisitCard {...card} />
                ))}
            </div>
        ) : (
            <NotFound />
        )}
    </div>
</section>
